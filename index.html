<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>云落图床</title>
    <link rel="stylesheet" href="https://fonts.font.im/icon?family=Material+Icons|Material+Icons+Outlined">
    <link rel="preconnect" href="https://fonts.font.im">
    <script src="https://fastly.jsdelivr.net/npm/js-sha256@0.9.0/src/sha256.min.js"></script>
<script src="./memorial-data.js"></script>
<style>
    /* --- 全局优化与重置 --- */
    *, *::before, *::after {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent; /* 移除移动端点击蓝色高亮 */
    }

    :root {
        /* 正常模式配色 */
        --md-sys-color-primary: #0061a4;
        --md-sys-color-on-primary: #ffffff;
        --md-sys-color-primary-container: #d1e4ff;
        --md-sys-color-on-primary-container: #001d36;
        --md-sys-color-background: #f8f9fc;
        --md-sys-color-on-background: #1a1c1e;
        --md-sys-color-surface: #fdfcff;
        --md-sys-color-on-surface: #1a1c1e;
        --md-sys-color-surface-variant: #dfe3eb;
        --md-sys-color-on-surface-variant: #42474e;
        --md-sys-color-outline: #e0e2e8;
        --md-sys-color-error: #ba1a1a;
        --md-sys-color-success: #386a1e;
        --transition-fast: 0.2s ease;
        --transition-medium: 0.3s ease;
    }

    body.dark-mode {
        /* 正常模式-深色配色 */
        --md-sys-color-primary: #9ecaff;
        --md-sys-color-on-primary: #003258;
        --md-sys-color-primary-container: #00497d;
        --md-sys-color-on-primary-container: #d1e4ff;
        --md-sys-color-background: #1a1c1e;
        --md-sys-color-on-background: #e2e2e6;
        --md-sys-color-surface: #25282d;
        --md-sys-color-on-surface: #e2e2e6;
        --md-sys-color-surface-variant: #42474e;
        --md-sys-color-on-surface-variant: #c2c7cf;
        --md-sys-color-outline: #3f4146;
        --md-sys-color-error: #ffb4ab;
        --md-sys-color-success: #a2d192;
    }
    
    /* --- 悼念模式（灰色）配色方案 - 优化后，更护眼 --- */
    body.grayscale-mode, body.grayscale-mode.dark-mode {
        /* 浅色背景：高对比度、护眼灰 */
        --md-sys-color-background: #f5f5f5; /* 柔和浅灰 */
        --md-sys-color-on-background: #212121; /* 近黑，高对比度 */
        
        --md-sys-color-surface: #ffffff; /* 卡片背景：纯白，突出内容 */
        --md-sys-color-on-surface: #212121;
        --md-sys-color-surface-variant: #ededed; /* 默认卡片背景色/输入框背景 */
        --md-sys-color-on-surface-variant: #616161; /* 次级文本/图标 */
        
        --md-sys-color-primary: #757575; /* 主要操作/按钮：中灰，庄重 */
        --md-sys-color-on-primary: #ffffff;
        --md-sys-color-primary-container: #e0e0e0; /* 浅灰容器 */
        --md-sys-color-on-primary-container: #424242;
        
        --md-sys-color-outline: #bdbdbd; /* 边框/分割线 */
        --md-sys-color-error: #757575; /* 灰色错误提示 */
        --md-sys-color-success: #757575; /* 灰色成功提示 */
        
        /* filter: grayscale(100%); 移除以保证更好的 UI 兼容性和性能 */
    }

    /* 针对深色模式的灰色微调，使其在深色背景下仍为灰色，且保持舒适对比度 */
    body.grayscale-mode.dark-mode {
        --md-sys-color-background: #252525; /* 柔和深灰 */
        --md-sys-color-on-background: #e0e0e0;
        
        --md-sys-color-surface: #363636;
        --md-sys-color-on-surface: #e0e0e0;
        --md-sys-color-surface-variant: #4a4a4a;
        --md-sys-color-on-surface-variant: #a0a0a0;
        
        --md-sys-color-primary: #9e9e9e; /* 中性灰，作为主要色 */
        --md-sys-color-on-primary: #121212;
        --md-sys-color-primary-container: #616161;
        --md-sys-color-on-primary-container: #d3d3d3;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        margin: 0;
        background-color: var(--md-sys-color-background);
        color: var(--md-sys-color-on-background);
        transition: background-color var(--transition-medium);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    
    /* --- 悼念横幅样式 (新增 Flex 布局和关闭按钮样式) --- */
    #memorialBanner {
        display: flex; /* 使用 Flex 布局 */
        justify-content: center; /* 内容居中 */
        align-items: center; /* 垂直居中 */
        /* 采用 on-background / background 的高对比度，确保横幅清晰 */
        /* 初始值将由 JS 覆盖为 memorial-data.js 中的 bannerStyle */
        background-color: var(--md-sys-color-on-background); 
        color: var(--md-sys-color-background);
        text-align: center;
        padding: 12px 16px; /* 调整内边距以容纳按钮 */
        font-size: 16px;
        font-weight: bold;
        letter-spacing: 1px;
        z-index: 1000;
        margin-bottom: 16px;
        position: sticky;
        top: 0;
        width: 100%;
        transition: background-color var(--transition-medium), color var(--transition-medium);
        cursor: pointer; /* 修复：增加指针样式 */
    }
    
    #memorialBannerText {
        flex-grow: 1; /* 让文本占据剩余空间 */
        margin-right: 16px; /* 与关闭按钮保持距离 */
    }

    #closeMemorialButton {
        background: none;
        border: none;
        color: inherit; /* 继承横幅的文本颜色 */
        cursor: pointer;
        padding: 4px;
        border-radius: 50%;
        transition: background-color var(--transition-fast);
        line-height: 1;
        flex-shrink: 0; /* 防止按钮被压缩 */
    }

    #closeMemorialButton:hover {
        background-color: rgba(255, 255, 255, 0.1); /* 鼠标悬停效果 */
    }
    
    #closeMemorialButton .material-icons {
        font-size: 20px;
        vertical-align: middle;
    }


    /* --- 布局与卡片（其余样式保持不变或跟随var()自动变色） --- */
    .container { width: 100%; max-width: 640px; margin: 0 auto; padding: 16px; }
    .app-bar { display: flex; justify-content: space-between; align-items: center; padding: 12px 4px; }
    h1 { font-size: 24px; font-weight: 700; color: var(--md-sys-color-primary); margin: 0; }
    .main-content { display: flex; flex-direction: column; gap: 16px; }
    .card { background-color: var(--md-sys-color-surface); border-radius: 24px; padding: 20px; border: 1px solid var(--md-sys-color-outline); transition: background-color var(--transition-medium), border-color var(--transition-medium); }
    .card-title { font-size: 14px; font-weight: 600; color: var(--md-sys-color-primary); margin: 0 0 16px 0; padding-left: 4px; display: flex; align-items: center; justify-content: space-between; }

    /* --- 原生 UI 组件重绘 (性能优化版) --- */
    .btn { display: inline-flex; align-items: center; justify-content: center; border: none; cursor: pointer; user-select: none; text-decoration: none; font-size: 14px; font-weight: 600; text-transform: none; border-radius: 100px; height: 48px; padding: 0 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: background-color var(--transition-fast), box-shadow var(--transition-fast); background-color: var(--md-sys-color-surface-variant); color: var(--md-sys-color-on-surface-variant); }
    .btn:active { transform: translateY(1px); filter: brightness(0.95); }
    .btn-raised { background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); }
    .btn-block { width: 100%; }
    .btn-icon { width: 40px; height: 40px; min-width: 40px; padding: 0; border-radius: 50%; box-shadow: none; background: transparent; }
    .btn-icon .material-icons { margin: 0; }
    .btn:disabled { background-color: var(--md-sys-color-surface-variant) !important; color: var(--md-sys-color-on-surface-variant) !important; opacity: 0.7; cursor: not-allowed; box-shadow: none; transform: none; filter: none; }
    
    .textfield { position: relative; margin: 16px 0; }
    .textfield-input { width: 100%; border: none; border-bottom: 1px solid var(--md-sys-color-on-surface-variant); padding: 8px 0; font-size: 16px; background-color: transparent; color: var(--md-sys-color-on-background); transition: border-bottom var(--transition-fast); }
    .textfield-input:focus { outline: none; border-bottom: 2px solid var(--md-sys-color-primary); }
    .textfield-label { position: absolute; left: 0; top: 8px; pointer-events: none; color: var(--md-sys-color-on-surface-variant); transition: all var(--transition-fast); }
    .textfield-input:focus + .textfield-label, .textfield-input:not(:placeholder-shown) + .textfield-label { top: -16px; font-size: 12px; color: var(--md-sys-color-primary); }

    .progress-container { width: 100%; height: 4px; background-color: var(--md-sys-color-surface-variant); border-radius: 4px; overflow: hidden; }
    .progress-bar { width: 0%; height: 100%; background-color: var(--md-sys-color-primary); transition: width var(--transition-medium); }

    .chip-group { display: flex; gap: 8px; margin-bottom: 16px; padding: 4px; background-color: var(--md-sys-color-surface-variant); border-radius: 12px; }
    .chip { flex: 1; background-color: transparent; color: var(--md-sys-color-on-surface-variant); font-weight: 500; cursor: pointer; transition: all var(--transition-fast); height: 40px; line-height: 40px; padding: 0 8px; border-radius: 10px; text-align: center; user-select: none; }
    .chip.active { background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    
    .dialog-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; opacity: 0; visibility: hidden; transition: opacity var(--transition-medium); }
    .dialog-overlay.visible { opacity: 1; visibility: visible; }
    .dialog { position: fixed; top: 50%; left: 50%; background-color: var(--md-sys-color-surface); color: var(--md-sys-color-on-surface); border-radius: 28px; width: calc(100% - 32px); max-width: 560px; z-index: 1001; transform: translate(-50%, -50%) scale(0.95); opacity: 0; visibility: hidden; transition: all var(--transition-medium); }
    .dialog-overlay.visible .dialog { transform: translate(-50%, -50%) scale(1); opacity: 1; visibility: visible; }
    .dialog-title { font-size: 22px; font-weight: 600; padding: 24px 24px 16px; }
    .dialog-content { padding: 0 24px 24px; colo